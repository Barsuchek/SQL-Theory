# Хранимые процедуры
Достоинства хранимых процедур:
1. Экономии времени
	
	Имя процедуры может быть коротким.
2. Оптимизации
	
	Хранимые процедуры заранее скомпелированы, их надо только вызвать.
3. Хранимые процедуры могут вызывать другие хранимые процедуры
4. Возможность использовать вставки кода из других языков программирования

## Настройка параметров синтаксиса хранимой процедуры
```SQL
SET ANSI_NULLS ON         --Включение использования значения NULL 
GO

SET QUOTED_IDENTIFIER ON  --Включение возможности использования кавычек для идентификаторов
GO
```

## Создание хранимой процедуры
Если вы хотите использовать название с пробелами, нужно поставить квадратные скобки либо двойные кавычки.

Для создания переменной нужно поставить знак @

```SQL
CREATE PROCEDURE [Название_процедуры]
	@Название_переменной
AS
BEGIN
	Запрос
END;
```

* **CREATE PROCEDURE** - Команда для создания хранимой процедуры
* **[Название_процедуры]** - Название для Вашей хранимой процедуры
* **@Название_переменной** - Название переменной, которую вы хотите создать
* **AS** - Команда, передающая значения в тело цикла
* **BEGIN** - Начала тела цикла
* **Запрос** - Запрос, который будет выполнять хранимая процедура
* **END** - Конец тела цикла
* **;** - Конец команды

**Пример:**

```SQL
CREATE PROCEDURE [Среднее значение]  --Создание процедуры с названием Среднее значение
	@w1 REAL =0,      --Создание переменной с типом данных REAL начальным значением =0
	@w2 REAL =0,      --Создание переменной с типом данных REAL начальным значением =0
	@w3 REAL =0       --Создание переменной с типом данных REAL начальным значением =0
AS
BEGIN
	SELECT 'Среднее значение'=(@w1+@w2+@w3)/3   --Вывести поле Среднее значение, в котором складываются три переменные и делятся на 3
END;
```

### Создание хранимой процедуры для поиска
```SQL
CREATE PROCEDURE Поиск_товара --Создание процедуры с названием Поиск_товара
	@Title VARCHAR(50) =''  --Создание переменной с типом данных VARCHAR, ограничением длинны символов 50 и пустым начальным значением
AS
BEGIN
	SELECT * FROM Shop WHERE Title=@Title  --Выбрать все поля из таблицы Shop если поле Title = переменной @Title
END;
```

## Запуск хранимой процедуры
```SQL
EXEC [Название хранимой процедуры] Значение_переменной1, Значение_переменной2 ...;
```

* **EXEC** - Команда для вызова хранимой процедуры
* **[Название хранимой процедуры]** - Название хранимой процедуры, которую Вы хотите вызвать
* **Значение_переменной1, Значение_переменной2** - Значения, которые Вы хотите дать переменным
* **;** - Конец команды

**Пример:**

```SQL
EXEC [Среднее значение] 1, 7, 9; --Вызвать хранимую процедуру Среднее значение с значениями переменных 1, 7, 9

EXEC Поиск_товара Мороженое;  --Вызвать хранимую процедуру Поиск_товара с значениями переменной Мороженое
```

## Изменение хранимой процедуры
```SQL
ALTER PROCEDURE [Название_процедуры]
	@Название_переменной
AS
BEGIN
	Запрос
END;
```

* **ALTER PROCEDURE** - Команда для изменения хранимой процедуры
* **[Название_процедуры]** - Название Вашей хранимой процедуры
* **@Название_переменной** - Название переменной, которую вы хотите создать
* **AS** - Команда, передающая значения в тело цикла
* **BEGIN** - Начала тела цикла
* **Запрос** - Запрос, который будет выполнять хранимая процедура
* **END** - Конец тела цикла
* **;** - Конец команды

**Пример:**

```SQL
ALTER PROCEDURE Поиск_товара --Создание процедуры с названием Поиск_товара
	@Names VARCHAR(50) =''  --Создание переменной с типом данных VARCHAR, ограничением длинны символов 50 и пустым начальным значением
AS
BEGIN
	SELECT * FROM Shop WHERE Title=@Names  --Выбрать все поля из таблицы Shop если поле Title = переменной @Names
END;
```

## Удаление хранимой процедуры
```SQL
DROP PROCEDURE Название_процедуры;
```

* **DROP PROCEDURE** - Команда для удаления процедуры
* **Название_процедуры** - Название процедуры, которую Вы хотите удалить
* **;** - Конец команды

**Пример:**

```SQL
DROP PROCEDURE [Среднее значение]; --Удалить процедуру Среднее значение
```